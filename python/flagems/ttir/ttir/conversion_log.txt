]633;E;for file in *.ttir;07241a48-b1a3-40c7-bd7c-b55949dce2dc]633;C/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:67:24: remark: MaskAnalysis failed
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:67:24: note: see current operation: %107 = tt.load %106, %88 : tensor<4x1x!tt.ptr<f32>>
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:67:24: remark: PtrAnalysis: Failed to rewrite LoadOp
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:67:24: note: see current operation: %107 = tt.load %106, %88 : tensor<4x1x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%35 = "tts.load"(%27, %34, %c0_i32) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%45 = "tts.load"(%37, %44, %c0_i32_1) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%55 = "tts.load"(%47, %54, %c0_i32_3) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%65 = "tts.load"(%57, %64, %c0_i32_5) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%35 = "tts.load"(%27, %34, %c0_i32) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%45 = "tts.load"(%37, %44, %c0_i32_1) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%55 = "tts.load"(%47, %54, %c0_i32_3) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%65 = "tts.load"(%57, %64, %c0_i32_5) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808, 1>}> : (tensor<4x1x!tt.ptr<i32>>, index, i32) -> tensor<4x1xi32>
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:71:43: remark: MaskAnalysis failed
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:71:43: note: see current operation: tt.store %131, %107, %88 : tensor<4x1x!tt.ptr<f32>>
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:71:43: remark: PtrAnalysis: Failed to rewrite StoreOp
/root/.flaggems/code_cache/index_put_inp_rank_4_indices_len_4_index_rank_1.py:71:43: note: see current operation: tt.store %131, %107, %88 : tensor<4x1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: note: see current operation: tt.store %25, %26 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: note: see current operation: tt.store %25, %26 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:69:22: note: see current operation: %22 = "tt.bitcast"(%21) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:55:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:55:0: note: see current operation: 
module {
  tt.func public @all_kernel_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg2: i32 {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %cst = arith.constant 1.000000e+00 : f32
    %c1024 = arith.constant 1024 : index
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<1024xf32>
    %c1024_i64 = arith.constant 1024 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c1024_i64 : i64
    %3 = arith.index_cast %2 : i64 to index
    %4 = tts.make_tptr %arg0 to sizes: [1024], strides: [1], offsets: [%3], shape: [0], order: [] : <f32> to tensor<1024x!tt.ptr<f32>>
    %5 = arith.addi %3, %c1024 : index
    %6 = arith.index_cast %arg2 : i32 to index
    %7 = arith.minsi %5, %6 : index
    %8 = arith.maxsi %7, %3 : index
    %9 = arith.subi %8, %3 : index
    %10 = "tts.load"(%4, %9, %cst) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808>}> : (tensor<1024x!tt.ptr<f32>>, index, f32) -> tensor<1024xf32>
    %11 = arith.cmpf une, %10, %cst_1 : tensor<1024xf32>
    %12 = "tt.reduce"(%11) <{axis = 0 : i32}> ({
    ^bb0(%arg4: i1, %arg5: i1):
      %18 = arith.andi %arg4, %arg5 : i1
      tt.reduce.return %18 : i1
    }) : (tensor<1024xi1>) -> i1
    %13 = arith.extsi %c0_i32 : i32 to i64
    %14 = arith.addi %13, %1 : i64
    %15 = tt.addptr %arg1, %1 : !tt.ptr<i1>, i64
    %16 = tt.bitcast %15 : !tt.ptr<i1> -> !tt.ptr<i8>
    %17 = arith.extui %12 : i1 to i8
    tt.store %16, %17 : !tt.ptr<i8>
    tt.return
  }
}
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:78:22: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:78:22: note: see current operation: %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:78:22: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:78:22: note: see current operation: %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: note: see current operation: tt.store %10, %11 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: note: see current operation: tt.store %10, %11 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:80:18: note: see current operation: %14 = "tt.bitcast"(%arg1) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:74:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/all.py:74:0: note: see current operation: 
module {
  tt.func public @all_kernel_2(%arg0: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg2: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %cst = arith.constant dense<1> : tensor<512xi8>
    %cst_1 = arith.constant dense<0> : tensor<512xi8>
    %0 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32>
    %1 = tt.splat %c0_i32_0 : i32 -> tensor<512xi32>
    %2 = tt.splat %arg0 : !tt.ptr<i1> -> tensor<512x!tt.ptr<i1>>
    %3 = tt.addptr %2, %0 : tensor<512x!tt.ptr<i1>>, tensor<512xi32>
    %4 = tt.splat %arg2 : i32 -> tensor<512xi32>
    %5 = arith.cmpi slt, %0, %4 : tensor<512xi32>
    %6 = tt.bitcast %3 : tensor<512x!tt.ptr<i1>> -> tensor<512x!tt.ptr<i8>>
    %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
    %8 = arith.cmpi ne, %7, %cst_1 : tensor<512xi8>
    %9 = "tt.reduce"(%8) <{axis = 0 : i32}> ({
    ^bb0(%arg3: i1, %arg4: i1):
      %12 = arith.andi %arg3, %arg4 : i1
      tt.reduce.return %12 : i1
    }) : (tensor<512xi1>) -> i1
    %10 = tt.bitcast %arg1 : !tt.ptr<i1> -> !tt.ptr<i8>
    %11 = arith.extui %9 : i1 to i8
    tt.store %10, %11 : !tt.ptr<i8>
    tt.return
  }
}
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:32:22: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:32:22: note: see current operation: tt.store %24, %23 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:32:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:32:22: note: see current operation: tt.store %24, %23 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:44:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:44:18: note: see current operation: tt.store %arg1, %11 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:44:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/amax.py:44:18: note: see current operation: tt.store %arg1, %11 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: note: see current operation: tt.store %25, %26 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: note: see current operation: tt.store %25, %26 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:69:22: note: see current operation: %22 = "tt.bitcast"(%21) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:55:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:55:0: note: see current operation: 
module {
  tt.func public @any_kernel_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg2: i32 {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %cst = arith.constant 0.000000e+00 : f32
    %c1024 = arith.constant 1024 : index
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<1024xf32>
    %c1024_i64 = arith.constant 1024 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c1024_i64 : i64
    %3 = arith.index_cast %2 : i64 to index
    %4 = tts.make_tptr %arg0 to sizes: [1024], strides: [1], offsets: [%3], shape: [0], order: [] : <f32> to tensor<1024x!tt.ptr<f32>>
    %5 = arith.addi %3, %c1024 : index
    %6 = arith.index_cast %arg2 : i32 to index
    %7 = arith.minsi %5, %6 : index
    %8 = arith.maxsi %7, %3 : index
    %9 = arith.subi %8, %3 : index
    %10 = "tts.load"(%4, %9, %cst) <{operandSegmentSizes = array<i32: 1, 1, 1>, static_mask_dims = array<i64: -9223372036854775808>}> : (tensor<1024x!tt.ptr<f32>>, index, f32) -> tensor<1024xf32>
    %11 = arith.cmpf une, %10, %cst_1 : tensor<1024xf32>
    %12 = "tt.reduce"(%11) <{axis = 0 : i32}> ({
    ^bb0(%arg4: i1, %arg5: i1):
      %18 = arith.ori %arg4, %arg5 : i1
      tt.reduce.return %18 : i1
    }) : (tensor<1024xi1>) -> i1
    %13 = arith.extsi %c0_i32 : i32 to i64
    %14 = arith.addi %13, %1 : i64
    %15 = tt.addptr %arg1, %1 : !tt.ptr<i1>, i64
    %16 = tt.bitcast %15 : !tt.ptr<i1> -> !tt.ptr<i8>
    %17 = arith.extui %12 : i1 to i8
    tt.store %16, %17 : !tt.ptr<i8>
    tt.return
  }
}
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:78:22: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:78:22: note: see current operation: %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:78:22: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:78:22: note: see current operation: %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: note: see current operation: tt.store %10, %11 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: note: see current operation: tt.store %10, %11 : !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:80:18: note: see current operation: %13 = "tt.bitcast"(%arg1) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:74:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/any.py:74:0: note: see current operation: 
module {
  tt.func public @any_kernel_2(%arg0: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg2: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %cst = arith.constant dense<0> : tensor<512xi8>
    %0 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32>
    %1 = tt.splat %c0_i32_0 : i32 -> tensor<512xi32>
    %2 = tt.splat %arg0 : !tt.ptr<i1> -> tensor<512x!tt.ptr<i1>>
    %3 = tt.addptr %2, %0 : tensor<512x!tt.ptr<i1>>, tensor<512xi32>
    %4 = tt.splat %arg2 : i32 -> tensor<512xi32>
    %5 = arith.cmpi slt, %0, %4 : tensor<512xi32>
    %6 = tt.bitcast %3 : tensor<512x!tt.ptr<i1>> -> tensor<512x!tt.ptr<i8>>
    %7 = tt.load %6, %5, %cst : tensor<512x!tt.ptr<i8>>
    %8 = arith.cmpi ne, %7, %cst : tensor<512xi8>
    %9 = "tt.reduce"(%8) <{axis = 0 : i32}> ({
    ^bb0(%arg3: i1, %arg4: i1):
      %12 = arith.ori %arg3, %arg4 : i1
      tt.reduce.return %12 : i1
    }) : (tensor<512xi1>) -> i1
    %10 = tt.bitcast %arg1 : !tt.ptr<i1> -> !tt.ptr<i8>
    %11 = arith.extui %9 : i1 to i8
    tt.store %10, %11 : !tt.ptr<i8>
    tt.return
  }
}
/workspace/FlagGems_sophgo/src/flag_gems/ops/dot.py:26:22: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/dot.py:26:22: note: see current operation: tt.store %arg2, %34 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/dot.py:26:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/dot.py:26:22: note: see current operation: tt.store %arg2, %34 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/embedding.py:28:22: remark: PtrAnalysis: scalar loadOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/embedding.py:28:22: note: see current operation: %9 = tt.load %6 : !tt.ptr<i32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/embedding.py:28:22: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/embedding.py:28:22: note: see current operation: %9 = tt.load %6 : !tt.ptr<i32>
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_1_bptr.py:101:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_1_bptr.py:101:84: note: see current operation: %16 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_1_bptr.py:66:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_1_bptr.py:66:0: note: see current operation: 
module {
  tt.func public @eq_func_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}, %arg4: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c512_i64 = arith.constant 512 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c512_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<512xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xf32>>) -> tensor<512xf32>
    %8 = tts.make_tptr %arg1 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<512xf32>>
    %9 = "tts.load"(%8) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xf32>>) -> tensor<512xf32>
    %10 = arith.cmpf oeq, %7, %9 : tensor<512xf32>
    %11 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %12 = tts.make_tptr %11 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<512xi8>>
    %13 = arith.extui %10 : tensor<512xi1> to tensor<512xi8>
    "tts.store"(%12, %13) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xi8>>, tensor<512xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:111:135: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:111:135: note: see current operation: %49 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:68:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:68:0: note: see current operation: 
module {
  tt.func public @eq_func_kernel_rank_3(%arg0: !tt.ptr<i32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32, %arg4: i32 {tt.divisibility = 16 : i32}, %arg5: i32 {tt.divisibility = 16 : i32}, %arg6: i32 {tt.divisibility = 16 : i32}, %arg7: i32, %arg8: i32, %arg9: i32, %arg10: i32, %arg11: i32, %arg12: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c7_i32 = arith.constant 7 : i32
    %c8_i32 = arith.constant 8 : i32
    %c3_i32 = arith.constant 3 : i32
    %c4_i32 = arith.constant 4 : i32
    %c8_i64 = arith.constant 8 : i64
    %c4_i64 = arith.constant 4 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.addi %arg10, %c7_i32 : i32
    %3 = arith.divsi %2, %c8_i32 : i32
    %4 = arith.addi %arg11, %c3_i32 : i32
    %5 = arith.divsi %4, %c4_i32 : i32
    %6 = arith.extsi %5 : i32 to i64
    %7 = arith.remsi %1, %6 : i64
    %8 = arith.divsi %1, %6 : i64
    %9 = arith.extsi %3 : i32 to i64
    %10 = arith.remsi %8, %9 : i64
    %11 = arith.divsi %8, %9 : i64
    %12 = arith.muli %11, %c4_i64 : i64
    %13 = arith.trunci %12 : i64 to i32
    %14 = arith.muli %10, %c8_i64 : i64
    %15 = arith.trunci %14 : i64 to i32
    %16 = arith.muli %7, %c4_i64 : i64
    %17 = arith.trunci %16 : i64 to i32
    %18 = arith.index_cast %arg3 : i32 to index
    %19 = arith.index_cast %13 : i32 to index
    %20 = arith.muli %19, %18 : index
    %21 = arith.index_cast %arg9 : i32 to index
    %22 = arith.index_cast %arg4 : i32 to index
    %23 = arith.index_cast %15 : i32 to index
    %24 = arith.muli %23, %22 : index
    %25 = arith.index_cast %arg10 : i32 to index
    %26 = arith.index_cast %17 : i32 to index
    %27 = arith.index_cast %arg11 : i32 to index
    %28 = tts.make_tptr %arg0 to sizes: [4, 8, 4], strides: [%18, %22, %c1], offsets: [%20, %24, %26], shape: [%21, %25, %27], order: [1, 2, 0] : <i32> to !tt.ptr<tensor<4x8x4xi32>>
    %29 = "tts.load"(%28) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<4x8x4xi32>>) -> tensor<4x8x4xi32>
    %30 = arith.index_cast %arg5 : i32 to index
    %31 = arith.muli %19, %30 : index
    %32 = arith.index_cast %arg6 : i32 to index
    %33 = arith.muli %26, %32 : index
    %34 = tts.make_tptr %arg1 to sizes: [4, 8, 4], strides: [%30, %c1, %32], offsets: [%31, %23, %33], shape: [%21, %25, %27], order: [0, 2, 1] : <i32> to !tt.ptr<tensor<4x8x4xi32>>
    %35 = "tts.load"(%34) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<4x8x4xi32>>) -> tensor<4x8x4xi32>
    %36 = arith.sitofp %29 : tensor<4x8x4xi32> to tensor<4x8x4xf32>
    %37 = arith.sitofp %35 : tensor<4x8x4xi32> to tensor<4x8x4xf32>
    %38 = arith.cmpf oeq, %36, %37 : tensor<4x8x4xf32>
    %39 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %40 = arith.index_cast %arg7 : i32 to index
    %41 = arith.muli %19, %40 : index
    %42 = arith.index_cast %arg8 : i32 to index
    %43 = arith.muli %23, %42 : index
    %44 = tts.make_tptr %39 to sizes: [4, 8, 4], strides: [%40, %42, %c1], offsets: [%41, %43, %26], shape: [%21, %25, %27], order: [2, 1, 0] : <i8> to !tt.ptr<tensor<4x8x4xi8>>
    %45 = arith.extui %38 : tensor<4x8x4xi1> to tensor<4x8x4xi8>
    "tts.store"(%44, %45) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<4x8x4xi8>>, tensor<4x8x4xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:102:130: error: non-decreasing dimension order on tensor pointers are not yet supported
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:102:130: error: failed to legalize operation 'tts.make_tptr' that was explicitly marked illegal
/root/.flaggems/code_cache/pointwise_dynamic_a3a4aa314d846ee6d6ed5902f98d08df926bf45439547091ba0d2de094347e4312_eq_func_kernel_rank_3_bptr.py:102:130: note: see current operation: %34 = "tts.make_tptr"(%arg0, %24, %28, %0, %26, %30, %32, %27, %31, %33) <{operandSegmentSizes = array<i32: 1, 3, 3, 3>, order = array<i32: 1, 2, 0>, sizes = array<i64: 4, 8, 4>, static_offsets = array<i64: -9223372036854775808, -9223372036854775808, -9223372036854775808>, static_shape = array<i64: -9223372036854775808, -9223372036854775808, -9223372036854775808>, static_strides = array<i64: -9223372036854775808, -9223372036854775808, -9223372036854775808>}> : (!tt.ptr<i32>, index, index, index, index, index, index, index, index, index) -> !tt.ptr<tensor<4x8x4xi32>>
/root/.flaggems/code_cache/pointwise_dynamic_fe293316e75d6765a1da71f68aa7005be4c61cb2453bbdff6548460a0820595128_eq_func_scalar_kernel_rank_1_bptr.py:93:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_fe293316e75d6765a1da71f68aa7005be4c61cb2453bbdff6548460a0820595128_eq_func_scalar_kernel_rank_1_bptr.py:93:84: note: see current operation: %14 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_fe293316e75d6765a1da71f68aa7005be4c61cb2453bbdff6548460a0820595128_eq_func_scalar_kernel_rank_1_bptr.py:62:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_fe293316e75d6765a1da71f68aa7005be4c61cb2453bbdff6548460a0820595128_eq_func_scalar_kernel_rank_1_bptr.py:62:0: note: see current operation: 
module {
  tt.func public @eq_func_scalar_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: f32, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32, %arg4: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c128_i64 = arith.constant 128 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c128_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [128], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<128xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<128xf32>>) -> tensor<128xf32>
    %8 = tt.splat %arg1 : f32 -> tensor<128xf32>
    %9 = arith.cmpf oeq, %7, %8 : tensor<128xf32>
    %10 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %11 = tts.make_tptr %10 to sizes: [128], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<128xi8>>
    %12 = arith.extui %9 : tensor<128xi1> to tensor<128xi8>
    "tts.store"(%11, %12) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<128xi8>>, tensor<128xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_e3ef24998eba8c2724764fa7ccf7ace68f1e7ff793ccb778472fa50a2d04967438_full_func_scalar_kernel_rank_1_bptr.py:93:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_e3ef24998eba8c2724764fa7ccf7ace68f1e7ff793ccb778472fa50a2d04967438_full_func_scalar_kernel_rank_1_bptr.py:93:84: note: see current operation: %8 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_e3ef24998eba8c2724764fa7ccf7ace68f1e7ff793ccb778472fa50a2d04967438_full_func_scalar_kernel_rank_1_bptr.py:62:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_e3ef24998eba8c2724764fa7ccf7ace68f1e7ff793ccb778472fa50a2d04967438_full_func_scalar_kernel_rank_1_bptr.py:62:0: note: see current operation: 
module {
  tt.func public @full_func_scalar_kernel_rank_1(%arg0: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg1: i1, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32, %arg4: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c32_i64 = arith.constant 32 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c32_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %5 = arith.index_cast %3 : i32 to index
    %6 = arith.index_cast %arg3 : i32 to index
    %7 = tts.make_tptr %4 to sizes: [32], strides: [%c1], offsets: [%5], shape: [%6], order: [0] : <i8> to !tt.ptr<tensor<32xi8>>
    %8 = arith.extui %arg1 : i1 to i8
    %9 = tt.splat %8 : i8 -> tensor<32xi8>
    "tts.store"(%7, %9) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xi8>>, tensor<32xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_5f17c6183e0e4de6de12854f4a1403ef3546c2f588968735b76c62a5c37e88849_ge_func_kernel_rank_1_bptr.py:101:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_5f17c6183e0e4de6de12854f4a1403ef3546c2f588968735b76c62a5c37e88849_ge_func_kernel_rank_1_bptr.py:101:84: note: see current operation: %16 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_5f17c6183e0e4de6de12854f4a1403ef3546c2f588968735b76c62a5c37e88849_ge_func_kernel_rank_1_bptr.py:66:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_5f17c6183e0e4de6de12854f4a1403ef3546c2f588968735b76c62a5c37e88849_ge_func_kernel_rank_1_bptr.py:66:0: note: see current operation: 
module {
  tt.func public @ge_func_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32, %arg4: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c32_i64 = arith.constant 32 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c32_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [32], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<32xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xf32>>) -> tensor<32xf32>
    %8 = tts.make_tptr %arg1 to sizes: [32], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<32xf32>>
    %9 = "tts.load"(%8) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xf32>>) -> tensor<32xf32>
    %10 = arith.cmpf oge, %7, %9 : tensor<32xf32>
    %11 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %12 = tts.make_tptr %11 to sizes: [32], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<32xi8>>
    %13 = arith.extui %10 : tensor<32xi1> to tensor<32xi8>
    "tts.store"(%12, %13) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xi8>>, tensor<32xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_843ff863c2fe4c9efbf14c083998561839a9003e66da50a6412518ec0ba399a120_ge_func_scalar_kernel_rank_1_bptr.py:93:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_843ff863c2fe4c9efbf14c083998561839a9003e66da50a6412518ec0ba399a120_ge_func_scalar_kernel_rank_1_bptr.py:93:84: note: see current operation: %14 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_843ff863c2fe4c9efbf14c083998561839a9003e66da50a6412518ec0ba399a120_ge_func_scalar_kernel_rank_1_bptr.py:62:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_843ff863c2fe4c9efbf14c083998561839a9003e66da50a6412518ec0ba399a120_ge_func_scalar_kernel_rank_1_bptr.py:62:0: note: see current operation: 
module {
  tt.func public @ge_func_scalar_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: f32, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32, %arg4: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c32_i64 = arith.constant 32 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c32_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [32], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<32xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xf32>>) -> tensor<32xf32>
    %8 = tt.splat %arg1 : f32 -> tensor<32xf32>
    %9 = arith.cmpf oge, %7, %8 : tensor<32xf32>
    %10 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %11 = tts.make_tptr %10 to sizes: [32], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<32xi8>>
    %12 = arith.extui %9 : tensor<32xi1> to tensor<32xi8>
    "tts.store"(%11, %12) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<32xi8>>, tensor<32xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_a664904335624fc541ee3a19a95be6092529ff4fd7b75cdeb3c45edb4c4f77c39_gt_func_kernel_rank_1_bptr.py:101:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_a664904335624fc541ee3a19a95be6092529ff4fd7b75cdeb3c45edb4c4f77c39_gt_func_kernel_rank_1_bptr.py:101:84: note: see current operation: %16 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_a664904335624fc541ee3a19a95be6092529ff4fd7b75cdeb3c45edb4c4f77c39_gt_func_kernel_rank_1_bptr.py:66:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_a664904335624fc541ee3a19a95be6092529ff4fd7b75cdeb3c45edb4c4f77c39_gt_func_kernel_rank_1_bptr.py:66:0: note: see current operation: 
module {
  tt.func public @gt_func_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}, %arg4: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c512_i64 = arith.constant 512 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c512_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<512xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xf32>>) -> tensor<512xf32>
    %8 = tts.make_tptr %arg1 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<512xf32>>
    %9 = "tts.load"(%8) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xf32>>) -> tensor<512xf32>
    %10 = arith.cmpf ogt, %7, %9 : tensor<512xf32>
    %11 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %12 = tts.make_tptr %11 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<512xi8>>
    %13 = arith.extui %10 : tensor<512xi1> to tensor<512xi8>
    "tts.store"(%12, %13) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xi8>>, tensor<512xi8>) -> ()
    tt.return
  }
}
/root/.flaggems/code_cache/pointwise_dynamic_1131b3c8afbb8b286591f420d4661d62ede4cd4ce426ff878ef220e2081174c320_gt_func_scalar_kernel_rank_1_bptr.py:93:84: error: unexpected op in ptr sequence
/root/.flaggems/code_cache/pointwise_dynamic_1131b3c8afbb8b286591f420d4661d62ede4cd4ce426ff878ef220e2081174c320_gt_func_scalar_kernel_rank_1_bptr.py:93:84: note: see current operation: %14 = "tt.bitcast"(%arg2) : (!tt.ptr<i1>) -> !tt.ptr<i8>
/root/.flaggems/code_cache/pointwise_dynamic_1131b3c8afbb8b286591f420d4661d62ede4cd4ce426ff878ef220e2081174c320_gt_func_scalar_kernel_rank_1_bptr.py:62:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/root/.flaggems/code_cache/pointwise_dynamic_1131b3c8afbb8b286591f420d4661d62ede4cd4ce426ff878ef220e2081174c320_gt_func_scalar_kernel_rank_1_bptr.py:62:0: note: see current operation: 
module {
  tt.func public @gt_func_scalar_kernel_rank_1(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: f32, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}, %arg4: i32 {tt.divisibility = 16 : i32}) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c1 = arith.constant 1 : index
    %c512_i64 = arith.constant 512 : i64
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = arith.muli %1, %c512_i64 : i64
    %3 = arith.trunci %2 : i64 to i32
    %4 = arith.index_cast %3 : i32 to index
    %5 = arith.index_cast %arg3 : i32 to index
    %6 = tts.make_tptr %arg0 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <f32> to !tt.ptr<tensor<512xf32>>
    %7 = "tts.load"(%6) <{operandSegmentSizes = array<i32: 1, 0, 0>, static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xf32>>) -> tensor<512xf32>
    %8 = tt.splat %arg1 : f32 -> tensor<512xf32>
    %9 = arith.cmpf ogt, %7, %8 : tensor<512xf32>
    %10 = tt.bitcast %arg2 : !tt.ptr<i1> -> !tt.ptr<i8>
    %11 = tts.make_tptr %10 to sizes: [512], strides: [%c1], offsets: [%4], shape: [%5], order: [0] : <i8> to !tt.ptr<tensor<512xi8>>
    %12 = arith.extui %9 : tensor<512xi1> to tensor<512xi8>
    "tts.store"(%11, %12) <{static_mask_dims = array<i64>}> : (!tt.ptr<tensor<512xi8>>, tensor<512xi8>) -> ()
    tt.return
  }
}
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%34 = arith.select %arg13, %33, %cst_2 : tensor<512xi1>, tensor<512xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:43: remark: PtrAnalysis: Failed to rewrite AddPtrOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:43: note: see current operation: %35 = tt.addptr %25, %34 : tensor<512x!tt.ptr<i32>>, tensor<512xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:26: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:26: note: see current operation: %36 = tt.load %35, %arg13 : tensor<512x!tt.ptr<i32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:26: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:151:26: note: see current operation: %36 = tt.load %35, %arg13 : tensor<512x!tt.ptr<i32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%43 = arith.select %41, %42, %arg7 : tensor<512xi1>, tensor<512xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: remark: PtrAnalysis: Failed to populate ptr state for tensor of indices
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured_6, %offsets_7, %strides_8 = "tts.get_structured_state"(%43) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%46 = arith.select %45, %34, %arg10 : tensor<512xi1>, tensor<512xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: remark: PtrAnalysis: Failed to populate ptr state for tensor of indices
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured_9, %offsets_10, %strides_11 = "tts.get_structured_state"(%46) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: note: see current operation: tt.store %31, %32, %11 : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: note: see current operation: tt.store %31, %32, %11 : tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: remark: Rewrite GetStructuredStateOp failed. Could not find PtrState.
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured, %offsets, %strides = "tts.get_structured_state"(%45) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: warning: Rewriting GetStructuredStateOp failed.
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured, %offsets, %strides = "tts.get_structured_state"(%45) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: remark: Rewrite GetStructuredStateOp failed. Could not find PtrState.
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured_5, %offsets_6, %strides_7 = "tts.get_structured_state"(%48) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: warning: Rewriting GetStructuredStateOp failed.
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:155:8: note: see current operation: %structured_5, %offsets_6, %strides_7 = "tts.get_structured_state"(%48) <{resultSegmentSizes = array<i32: 1, 1, 1>}> : (tensor<512xi32>) -> (tensor<512xi32>, index, index)
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:188:12: note: called from
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:158:27: note: see current operation: %41 = "tt.bitcast"(%40) : (tensor<512x!tt.ptr<i1>>) -> tensor<512x!tt.ptr<i8>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:163:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/isin.py:163:0: note: see current operation: 
module {
  tt.func public @isin_by_search_kernel(%arg0: !tt.ptr<i32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<i32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<i1> {tt.divisibility = 16 : i32}, %arg3: i32 {tt.divisibility = 16 : i32}, %arg4: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c512 = arith.constant 512 : index
    %cst = arith.constant dense<false> : tensor<512xi1>
    %c1_i32 = arith.constant 1 : i32
    %c8_i32 = arith.constant 8 : i32
    %c0_i32_2 = arith.constant 0 : i32
    %cst_3 = arith.constant dense<1> : tensor<512xi32>
    %cst_4 = arith.constant dense<2> : tensor<512xi32>
    %c512_i64 = arith.constant 512 : i64
    %cst_5 = arith.constant dense<0> : tensor<512xi32>
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = tt.make_range {end = 512 : i32, start = 0 : i32} : tensor<512xi32>
    %3 = arith.muli %1, %c512_i64 : i64
    %4 = arith.index_cast %3 : i64 to index
    %5 = arith.extsi %2 : tensor<512xi32> to tensor<512xi64>
    %6 = tt.splat %3 : i64 -> tensor<512xi64>
    %7 = arith.addi %6, %5 : tensor<512xi64>
    %8 = arith.extsi %arg3 : i32 to i64
    %9 = tt.splat %8 : i64 -> tensor<512xi64>
    %10 = arith.cmpi slt, %7, %9 : tensor<512xi64>
    %11 = tts.make_tptr %arg0 to sizes: [512], strides: [1], offsets: [%4], shape: [0], order: [] : <i32> to tensor<512x!tt.ptr<i32>>
    %12 = arith.addi %4, %c512 : index
    %13 = arith.index_cast %arg3 : i32 to index
    %14 = arith.minsi %12, %13 : index
    %15 = arith.maxsi %14, %4 : index
    %16 = arith.subi %15, %4 : index
    %17 = "tts.load"(%11, %16) <{operandSegmentSizes = array<i32: 1, 1, 0>, static_mask_dims = array<i64: -9223372036854775808>}> : (tensor<512x!tt.ptr<i32>>, index) -> tensor<512xi32>
    %18 = tt.splat %arg4 : i32 -> tensor<512xi32>
    %19 = arith.cmpi sgt, %arg4, %c0_i32_2 : i32
    %20 = tt.splat %19 : i1 -> tensor<512xi1>
    %21 = tt.splat %c0_i32_0 : i32 -> tensor<512xi32>
    %22 = tt.splat %arg1 : !tt.ptr<i32> -> tensor<512x!tt.ptr<i32>>
    %23:4 = scf.for %arg5 = %c0_i32_2 to %c8_i32 step %c1_i32 iter_args(%arg6 = %cst, %arg7 = %cst_5, %arg8 = %18, %arg9 = %20) -> (tensor<512xi1>, tensor<512xi32>, tensor<512xi32>, tensor<512xi1>)  : i32 {
      %31 = arith.subi %arg8, %arg7 : tensor<512xi32>
      %32 = arith.divsi %31, %cst_4 : tensor<512xi32>
      %33 = arith.addi %arg7, %32 : tensor<512xi32>
      %34 = arith.select %arg9, %33, %cst_5 : tensor<512xi1>, tensor<512xi32>
      %35 = arith.addi %21, %34 : tensor<512xi32>
      %36 = tt.addptr %22, %34 : tensor<512x!tt.ptr<i32>>, tensor<512xi32>
      %37 = tt.load %36, %arg9 : tensor<512x!tt.ptr<i32>>
      %38 = arith.cmpi eq, %37, %17 : tensor<512xi32>
      %39 = arith.ori %arg6, %38 : tensor<512xi1>
      %40 = arith.select %arg9, %39, %arg6 : tensor<512xi1>, tensor<512xi1>
      %41 = arith.cmpi slt, %37, %17 : tensor<512xi32>
      %42 = arith.andi %arg9, %41 : tensor<512xi1>
      %43 = arith.addi %34, %cst_3 : tensor<512xi32>
      %44 = arith.select %42, %43, %arg7 : tensor<512xi1>, tensor<512xi32>
      %45 = arith.cmpi sgt, %37, %17 : tensor<512xi32>
      %46 = arith.andi %arg9, %45 : tensor<512xi1>
      %47 = arith.select %46, %34, %arg8 : tensor<512xi1>, tensor<512xi32>
      %48 = arith.cmpi slt, %44, %47 : tensor<512xi32>
      scf.yield %40, %44, %47, %48 : tensor<512xi1>, tensor<512xi32>, tensor<512xi32>, tensor<512xi1>
    }
    %24 = tt.splat %c0_i32 : i32 -> tensor<512xi32>
    %25 = tt.splat %arg2 : !tt.ptr<i1> -> tensor<512x!tt.ptr<i1>>
    %26 = arith.extsi %24 : tensor<512xi32> to tensor<512xi64>
    %27 = arith.addi %26, %7 : tensor<512xi64>
    %28 = tt.addptr %25, %7 : tensor<512x!tt.ptr<i1>>, tensor<512xi64>
    %29 = tt.bitcast %28 : tensor<512x!tt.ptr<i1>> -> tensor<512x!tt.ptr<i8>>
    %30 = arith.extui %23#0 : tensor<512xi1> to tensor<512xi8>
    tt.store %29, %30, %10 : tensor<512x!tt.ptr<i8>>
    tt.return
  }
}
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:51:18: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:51:18: note: see current operation: tt.store %12, %25 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:51:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:51:18: note: see current operation: tt.store %12, %25 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:62:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:62:18: note: see current operation: tt.store %arg1, %12 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:62:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/vector_norm.py:62:18: note: see current operation: tt.store %arg1, %12 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/mm.py:88:18: warning: PtrAnalysis: allowing adding pointer state with modulo in dim 0 to another pointer state with offset in dim 0.
Please verify the operand that contains a scalar is meant to increment pointers in dim1. If that is not the case it WILL LEAD TO WRONG COMPILATION RESULTS.

To avoid this warning, use expand_dims (instead of splat) to explicitly specify which dimension contains the scalar.
/workspace/FlagGems_sophgo/src/flag_gems/ops/mm.py:88:18: note: see current operation: %95 = tt.addptr %arg11, %cst : tensor<128x32x!tt.ptr<f32>>, tensor<128x32xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:39:22: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:39:22: note: see current operation: tt.store %24, %23 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:39:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:39:22: note: see current operation: tt.store %24, %23 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:57:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:57:18: note: see current operation: tt.store %arg1, %11 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:57:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/sum.py:57:18: note: see current operation: tt.store %arg1, %11 : !tt.ptr<f32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:192:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:192:16: note: see current operation: %347 = tt.load %345, %289, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:192:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:192:16: note: see current operation: %347 = tt.load %345, %289, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:197:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:197:16: note: see current operation: %356 = tt.load %354, %291, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:197:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:197:16: note: see current operation: %356 = tt.load %354, %291, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:202:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:202:16: note: see current operation: %365 = tt.load %363, %292, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:202:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:202:16: note: see current operation: %365 = tt.load %363, %292, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:207:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:207:16: note: see current operation: %374 = tt.load %372, %293, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:207:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:207:16: note: see current operation: %374 = tt.load %372, %293, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:212:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:212:16: note: see current operation: %383 = tt.load %381, %294, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:212:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:212:16: note: see current operation: %383 = tt.load %381, %294, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:218:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:218:16: note: see current operation: %394 = tt.load %392, %296, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:218:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:218:16: note: see current operation: %394 = tt.load %392, %296, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:223:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:223:16: note: see current operation: %407 = tt.load %405, %297, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:223:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:223:16: note: see current operation: %407 = tt.load %405, %297, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:228:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:228:16: note: see current operation: %420 = tt.load %418, %298, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:228:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:228:16: note: see current operation: %420 = tt.load %418, %298, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:233:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:233:16: note: see current operation: %433 = tt.load %431, %299, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:233:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:233:16: note: see current operation: %433 = tt.load %431, %299, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:238:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:238:16: note: see current operation: %446 = tt.load %444, %300, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:238:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:238:16: note: see current operation: %446 = tt.load %444, %300, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:244:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:244:16: note: see current operation: %457 = tt.load %455, %302, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:244:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:244:16: note: see current operation: %457 = tt.load %455, %302, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:249:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:249:16: note: see current operation: %470 = tt.load %468, %309, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:249:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:249:16: note: see current operation: %470 = tt.load %468, %309, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:254:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:254:16: note: see current operation: %483 = tt.load %481, %312, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:254:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:254:16: note: see current operation: %483 = tt.load %481, %312, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:259:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:259:16: note: see current operation: %496 = tt.load %494, %315, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:259:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:259:16: note: see current operation: %496 = tt.load %494, %315, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:264:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:264:16: note: see current operation: %509 = tt.load %507, %318, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:264:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:264:16: note: see current operation: %509 = tt.load %507, %318, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:270:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:270:16: note: see current operation: %520 = tt.load %518, %320, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:270:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:270:16: note: see current operation: %520 = tt.load %518, %320, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:275:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:275:16: note: see current operation: %533 = tt.load %531, %327, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:275:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:275:16: note: see current operation: %533 = tt.load %531, %327, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:280:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:280:16: note: see current operation: %546 = tt.load %544, %330, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:280:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:280:16: note: see current operation: %546 = tt.load %544, %330, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:285:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:285:16: note: see current operation: %559 = tt.load %557, %333, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:285:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:285:16: note: see current operation: %559 = tt.load %557, %333, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:290:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:290:16: note: see current operation: %572 = tt.load %570, %336, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:290:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:290:16: note: see current operation: %572 = tt.load %570, %336, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:296:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:296:16: note: see current operation: %583 = tt.load %581, %338, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:296:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:296:16: note: see current operation: %583 = tt.load %581, %338, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:301:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:301:16: note: see current operation: %596 = tt.load %594, %345, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:301:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:301:16: note: see current operation: %596 = tt.load %594, %345, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:306:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:306:16: note: see current operation: %609 = tt.load %607, %348, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:306:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:306:16: note: see current operation: %609 = tt.load %607, %348, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:311:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:311:16: note: see current operation: %622 = tt.load %620, %351, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:311:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:311:16: note: see current operation: %622 = tt.load %620, %351, %cst_10 : tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%24 = arith.fptosi %23 : tensor<64xf32> to tensor<64xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:316:16: remark: MaskAnalysis failed
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:316:16: note: see current operation: %635 = tt.load %633, %354, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:316:16: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:316:16: note: see current operation: %635 = tt.load %633, %354, %cst_10 : tensor<1x64x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:365:39: error: 'bufferization.materialize_in_destination' op failed to verify that all of {source, dest} have same element type
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_bicubic2d_aa.py:365:39: note: see current operation: %565 = "bufferization.materialize_in_destination"(%545, %564) <{writable}> : (tensor<1x64xf32>, tensor<1x64x!tt.ptr<f32>>) -> tensor<1x64x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%14 = arith.divsi %10, %12 : tensor<2048xi64>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%25 = arith.minsi %22, %24 : tensor<2048xi32>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%32 = arith.minsi %29, %31 : tensor<2048xi32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:27: remark: PtrAnalysis: Failed to rewrite AddPtrOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:27: note: see current operation: %50 = tt.addptr %49, %48 : tensor<2048x!tt.ptr<f32>>, tensor<2048xi64>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:19: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:19: note: see current operation: %51 = tt.load %50 : tensor<2048x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:19: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:52:19: note: see current operation: %51 = tt.load %50 : tensor<2048x!tt.ptr<f32>>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%14 = arith.divsi %10, %12 : tensor<2048xi64>
PtrAnalysis: encountered addptr operand produced by an unsupported operation
%10 = arith.divsi %6, %8 : tensor<2048xi64>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:50:46: remark: PtrAnalysis: do not support this pattern: a + arange(0, K) % M
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:50:46: note: see current operation: %42 = arith.addi %41, %12 : tensor<2048xi64>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:21: remark: PtrAnalysis: Failed to rewrite AddPtrOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:21: note: see current operation: %59 = tt.addptr %58, %42 : tensor<2048x!tt.ptr<f32>>, tensor<2048xi64>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:31: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:31: note: see current operation: tt.store %59, %57 : tensor<2048x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:31: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/upsample_nearest2d.py:53:31: note: see current operation: tt.store %59, %57 : tensor<2048x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:96:22: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:96:22: note: see current operation: tt.store %15, %32 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:96:22: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:96:22: note: see current operation: tt.store %15, %32 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:97:18: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:97:18: note: see current operation: tt.store %14, %38 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:97:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:97:18: note: see current operation: tt.store %14, %38 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:98:20: remark: PtrAnalysis: scalar storeOp will not be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:98:20: note: see current operation: tt.store %16, %29 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:98:20: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:98:20: note: see current operation: tt.store %16, %29 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:120:23: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:120:23: note: see current operation: %3 = tt.load %0 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:120:23: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:120:23: note: see current operation: %3 = tt.load %0 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:121:31: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:121:31: note: see current operation: %4 = tt.load %1 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:121:31: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:121:31: note: see current operation: %4 = tt.load %1 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:122:27: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:122:27: note: see current operation: %5 = tt.load %2 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:122:27: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:122:27: note: see current operation: %5 = tt.load %2 : tensor<1x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:127:19: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:127:19: note: see current operation: tt.store %arg4, %6#0 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:127:19: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:127:19: note: see current operation: tt.store %arg4, %6#0 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:128:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so storeOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:128:18: note: see current operation: tt.store %arg3, %9 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:128:18: remark: PtrAnalysis: Failed to rewrite StoreOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/var_mean.py:128:18: note: see current operation: tt.store %arg3, %9 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:46:59: remark: Unexpected defining op for triton pointer operand
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:46:59: note: see current operation: %10 = arith.select %9, %arg3, %8 : !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:57:31: remark: PtrAnalysis: Failed to rewrite AddPtrOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:57:31: note: see current operation: %27 = tt.addptr %26, %23 : tensor<4096x!tt.ptr<f32>>, tensor<4096xi64>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:60:18: remark: PtrAnalysis: pointer is not replace with tts.make_tptr so loadOp cannot be rewritten
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:60:18: note: see current operation: %38 = tt.load %28, %26 : tensor<4096x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:60:18: remark: PtrAnalysis: Failed to rewrite LoadOp
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:60:18: note: see current operation: %38 = tt.load %28, %26 : tensor<4096x!tt.ptr<f32>>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:44:59: error: unexpected op in ptr sequence
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:44:59: note: see current operation: %17 = "arith.select"(%16, %arg0, %arg1) : (i1, !tt.ptr<f32>, !tt.ptr<f32>) -> !tt.ptr<f32>
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:21:0: warning: Cannot transform tensor of pointers into a single base pointer with tensor of offsets
/workspace/FlagGems_sophgo/src/flag_gems/ops/vstack.py:21:0: note: see current operation: 
module {
  tt.func public @vstack_kernel(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg1: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg2: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg3: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg4: !tt.ptr<f32> {tt.divisibility = 16 : i32}, %arg5: i32, %arg6: i32, %arg7: i32 {tt.divisibility = 16 : i32}, %arg8: i32, %arg9: i32, %arg10: i32, %arg11: i32 {tt.divisibility = 16 : i32}, %arg12: i32, %arg13: i32) attributes {noinline = false} {
    %c0_i32 = arith.constant 0 : i32
    %c0_i32_0 = arith.constant 0 : i32
    %c0_i32_1 = arith.constant 0 : i32
    %c0_i32_2 = arith.constant 0 : i32
    %c0_i32_3 = arith.constant 0 : i32
    %c4096 = arith.constant 4096 : index
    %c3_i64 = arith.constant 3 : i64
    %c2_i64 = arith.constant 2 : i64
    %c0_i64 = arith.constant 0 : i64
    %c4096_i64 = arith.constant 4096 : i64
    %c1_i32 = arith.constant 1 : i32
    %0 = tt.get_program_id x : i32
    %1 = arith.extsi %0 : i32 to i64
    %2 = tt.get_program_id y : i32
    %3 = arith.extsi %2 : i32 to i64
    %4 = tt.make_range {end = 4096 : i32, start = 0 : i32} : tensor<4096xi32>
    %5 = arith.cmpi eq, %3, %c0_i64 : i64
    %6 = arith.select %5, %arg0, %arg1 : !tt.ptr<f32>
    %7 = arith.cmpi eq, %3, %c2_i64 : i64
    %8 = arith.select %7, %arg2, %6 : !tt.ptr<f32>
    %9 = arith.cmpi eq, %3, %c3_i64 : i64
    %10 = arith.select %9, %arg3, %8 : !tt.ptr<f32>
    %11 = arith.select %5, %arg7, %arg8 : i32
    %12 = arith.select %7, %arg9, %11 : i32
    %13 = arith.select %9, %arg10, %12 : i32
    %14 = arith.select %5, %arg5, %arg6 : i32
    %15 = arith.select %7, %c1_i32, %14 : i32
    %16 = arith.select %9, %c1_i32, %15 : i32
    %17 = arith.extsi %arg12 : i32 to i64
    %18 = arith.extsi %16 : i32 to i64
    %19 = arith.muli %18, %17 : i64
    %20 = arith.muli %1, %c4096_i64 : i64
    %21 = arith.index_cast %20 : i64 to index
    %22 = arith.extsi %4 : tensor<4096xi32> to tensor<4096xi64>
    %23 = tt.splat %20 : i64 -> tensor<4096xi64>
    %24 = arith.addi %23, %22 : tensor<4096xi64>
    %25 = tt.splat %19 : i64 -> tensor<4096xi64>
    %26 = arith.cmpi slt, %24, %25 : tensor<4096xi64>
    %27 = tt.splat %10 : !tt.ptr<f32> -> tensor<4096x!tt.ptr<f32>>
    %28 = tt.addptr %27, %24 : tensor<4096x!tt.ptr<f32>>, tensor<4096xi64>
    %29 = arith.addi %arg11, %13 : i32
    %30 = arith.extsi %29 : i32 to i64
    %31 = arith.muli %30, %17 : i64
    %32 = arith.index_cast %31 : i64 to index
    %33 = arith.addi %32, %21 : index
    %34 = tts.make_tptr %arg4 to sizes: [4096], strides: [1], offsets: [%33], shape: [0], order: [] : <f32> to tensor<4096x!tt.ptr<f32>>
    %35 = tt.load %28, %26 : tensor<4096x!tt.ptr<f32>>
    %36 = arith.addi %21, %c4096 : index
    %37 = arith.index_cast %19 : i64 to index
    %38 = arith.minsi %36, %37 : index
    %39 = arith.maxsi %38, %21 : index
    %40 = arith.subi %39, %21 : index
    "tts.store"(%34, %35, %40) <{static_mask_dims = array<i64: -9223372036854775808>}> : (tensor<4096x!tt.ptr<f32>>, tensor<4096xf32>, index) -> ()
    tt.return
  }
}
